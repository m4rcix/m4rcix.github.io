<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>SQpLosIon | m4rcix</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="SQpLosIon" />
<meta name="author" content="m4rcix" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This one came with a bang" />
<meta property="og:description" content="This one came with a bang" />
<link rel="canonical" href="https://m4rcix.github.io/SecChall21/web/sqplosion" />
<meta property="og:url" content="https://m4rcix.github.io/SecChall21/web/sqplosion" />
<meta property="og:site_name" content="m4rcix" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-03-17T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="SQpLosIon" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"SQpLosIon","dateModified":"2021-03-17T00:00:00+00:00","datePublished":"2021-03-17T00:00:00+00:00","url":"https://m4rcix.github.io/SecChall21/web/sqplosion","mainEntityOfPage":{"@type":"WebPage","@id":"https://m4rcix.github.io/SecChall21/web/sqplosion"},"author":{"@type":"Person","name":"m4rcix"},"description":"This one came with a bang","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css">
  <link rel="icon" type="image/png" href="/assets/favicon.png" /><link type="application/atom+xml" rel="alternate" href="https://m4rcix.github.io/feed.xml" title="m4rcix" /></head>
<body><div class="site-header">
  <div class="wrapper">
    <a class="site-title" rel="author" href="/">m4rcix<b class="command_prompt"></b><b class="blinking_cursor">_</b></a>
    <span class="social_links">
        
        
        <a class="color-cyan-hover" href="https://twitter.com/MarcixWasTaken"><i class="fab fa-twitter-square"></i></a>
        
        
        
        <a class="color-purple-hover" href="https://www.twitch.tv/marcix"><i class="fab fa-twitch"></i></a>
        
        
        
        <a class="color-red-hover" href="https://www.youtube.com/channel/UChaUSPtWwNkUpzrjUW7H0PA"><i class="fab fa-youtube"></i></a>
        
        
        
        <a class="color-yellow-hover" href="https://github.com/m4rcix"><i class="fab fa-github-square"></i></a>
        
        
        
        <a class="color-blue-hover" href="https://www.linkedin.com/in/marton-bak-574a59201/"><i class="fab fa-linkedin"></i></a>
        
        
        
        <a class="color-green-hover" href="https://app.hackthebox.eu/profile/367067"><i class="fa fa-cube"></i></a>
        
        
        
        <a class="color-blue-hover" href="https://discord.com/invite/wGHG5Aj"><i class="fab fa-discord"></i></a>
        
        
    </span>
  </div>
</div>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        
<div class="post">
  <h1 class="post-title">SQpLosIon</h1>
  
  <div class="post-tags">
      
      <a class="tag" href="/tag/web/">web</a>
      
      <a class="tag" href="/tag/secchallenge/">secchallenge</a>
      
  </div>
  
  <div class="post-date">Published on 17 Mar 2021</div>
  
  <noscript>
    <div class="post-description">This one came with a bang</div>
  </noscript>
  <div id="animated-post-description" class="post-description" style="display: none;"></div>
  
  <h2 id="description">Description</h2>

<p>A manual? Coordinates?</p>

<p>Damn. Joe maybe already possess an anti-apocalypse machine. What is he up to? You have to get there before him.</p>

<p>You head out, but as you get close to the marked location, you see Joe his Warboys, and multiple war rigs. You need to access the controller of the war rigs remotely and blow them up. Hurry up the fate of the wastes is in your hands.</p>

<p><a href="https://sqlplosion.secchallenge.crysys.hu">https://sqlplosion.secchallenge.crysys.hu</a></p>

<ul>
  <li>Author: Pepe</li>
  <li>Difficulty: easy</li>
</ul>

<h2 id="solution">Solution</h2>

<p>Reading the challenge name, one might suspect, that it has something to do with SQL injection, and one would be right.</p>

<p>After looking around for other accessible pages with <code class="language-plaintext highlighter-rouge">dirbuster</code> and finding nothing of useful, I intercepted the raw login request and grabbed a cup of coffee while letting <code class="language-plaintext highlighter-rouge">sqlmap</code> do its thing.</p>

<p>After some time, it dumped the whole database, with one interesting Database named <code class="language-plaintext highlighter-rouge">secchallenge</code> with a Table named <code class="language-plaintext highlighter-rouge">users</code> in it. Here we go, we got some stuff.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+----+----------+-------+----------------------------------+
| id | name     | role  | password                         |
+----+----------+-------+----------------------------------+
| 1  | Nux      | user  | c0ddd29267facb1bca6c370d3b918bf1 |
| 2  | Rictus   | user  | c0ddd29267facb1bcacc370d3b918bf2 |
| 3  | Slit     | user  | c0ddd29267facb1bca5c370d3b918bf3 |
| 4  | Ace      | user  | c0ddd29267facb1bc16c370d3b918bf4 |
| 5  | Morsov   | user  | c0ddd29267facb1bcd6c370d3b918bf5 |
| 6  | Furiosa  | user  | c0ddd29267facb1bcc6c370d3b918bf6 |
| 7  | Joe      | admin | c0ddd29267facb1bca6c370d3b918bf7 |
| 8  | Scabrous | user  | c0ddd29267f1cb1bcaac370d3b918bf8 |
+----+----------+-------+----------------------------------+
</code></pre></div></div>

<p>Looking at the password field however, nothing came to my mind. It has a bunch of random stuff in it, and clearly, it has some pre and postfix, plus the id appended at the end. But this yielded nothing so I started thinking.</p>

<p>If this section was injectable in the first place, then there should be something we can use. <code class="language-plaintext highlighter-rouge">sqlmap</code> was kind enough to tell us, that the <code class="language-plaintext highlighter-rouge">user</code> parameter was the injectable one.</p>

<p>Let’s make some kind of dummy SQL statement ourselves, and try to figure out what to enter:</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">FROM</span> <span class="n">users</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">WHERE</span> <span class="k">user</span> <span class="o">=</span> <span class="s1">'$user'</span> <span class="k">and</span> <span class="n">password</span> <span class="o">=</span> <span class="s1">'$passwd'</span>
</code></pre></div></div>

<p>The dumped table above tells us, which user we want to log in with (why not get admin rights right away), and the little dummy statement I just wrote, helped me figure out what to enter.</p>

<p>After I successfully logged in as an admin, I got the flag.</p>

<p>The acquired flag is:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd21{HIDDEN}
</code></pre></div></div>

<p><a href="/SecChall21">← Back to SecChallenge21</a></p>

</div>







  
  <h2>all tags</h2>
  <div class="tag-cloud"><a href="/tag/ctf/" class="set-1">CTF</a> <a href="/tag/crypto/" class="set-1">crypto</a> <a href="/tag/crysys/" class="set-1">crysys</a> <a href="/tag/dnspy/" class="set-1">dnSpy</a> <a href="/tag/hardware/" class="set-2">hardware</a> <a href="/tag/misc/" class="set-2">misc</a> <a href="/tag/pwn/" class="set-1">pwn</a> <a href="/tag/reverse/" class="set-1">reverse</a> <a href="/tag/secchallenge/" class="set-5">secchallenge</a> <a href="/tag/web/" class="set-2">web</a></div>
  




<script>
  let i = 0;
  const text = 'This one came with a bang';
  const speed = parseInt('50');
  
  function typeWriter() {
    if (i < text.length) {
      document.getElementById('animated-post-description').innerHTML += text.charAt(i);
      i++;
      setTimeout(typeWriter, speed);
    }
  }

  document.getElementById('animated-post-description').style.display = 'initial';
  typeWriter();
</script>

      </div>
    </main><footer class="site-footer">
  <div class="wrapper">
    <div class="credits"><a href="https://github.com/bitbrain/jekyll-dash">dash</a> theme for Jekyll by <a href="https://github.com/bitbrain">bitbrain</a> made with <i class="fas fa-heart"></i><div class="toggleWrapper">
    <input type="checkbox" class="dn" id="theme-toggle" onclick="modeSwitcher()" checked />
    <label for="theme-toggle" class="toggle">
    <span class="toggle__handler">
      <span class="crater crater--1"></span>
      <span class="crater crater--2"></span>
      <span class="crater crater--3"></span>
    </span>
        <span class="star star--1"></span>
        <span class="star star--2"></span>
        <span class="star star--3"></span>
        <span class="star star--4"></span>
        <span class="star star--5"></span>
        <span class="star star--6"></span>
    </label>
</div>
<script type="text/javascript">
const theme = localStorage.getItem('theme');

if (theme === "light") {
    document.documentElement.setAttribute('data-theme', 'light');
} else {
    document.documentElement.setAttribute('data-theme', 'dark');
}
const userPrefers = getComputedStyle(document.documentElement).getPropertyValue('content');

function activateDarkTheme() {
    document.getElementById('theme-toggle').checked = true;
    document.documentElement.setAttribute('data-theme', 'dark');
    document.documentElement.classList.add('theme--dark');
    document.documentElement.classList.remove('theme--light');
	document.getElementById("theme-toggle").className = 'light';
	window.localStorage.setItem('theme', 'dark');
}

function activateLightTheme() {
    document.getElementById('theme-toggle').checked = false;
    document.documentElement.setAttribute('data-theme', 'light');
    document.documentElement.classList.add('theme--light');
    document.documentElement.classList.remove('theme--dark');
	document.getElementById("theme-toggle").className = 'dark';
	window.localStorage.setItem('theme', 'light');
}

if (theme === "dark") {
    activateDarkTheme();
} else if (theme === "light") {
    activateLightTheme();
} else if  (userPrefers === "light") {
    activateDarkTheme();
} else {
    activateDarkTheme();
}

function modeSwitcher() {
	let currentMode = document.documentElement.getAttribute('data-theme');
	if (currentMode === "dark") {
	    activateLightTheme();
	} else {
	    activateDarkTheme();
	}
}
</script></div>
  </div>
</footer>


<script>
      window.FontAwesomeConfig = {
        searchPseudoElements: true
      }
    </script>
  </body>

</html>

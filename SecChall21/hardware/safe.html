<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>A safe place | m4rcix</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="A safe place" />
<meta name="author" content="m4rcix" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Oh boy, I almost put hard earned cash in there" />
<meta property="og:description" content="Oh boy, I almost put hard earned cash in there" />
<link rel="canonical" href="https://m4rcix.github.io/SecChall21/hardware/safe" />
<meta property="og:url" content="https://m4rcix.github.io/SecChall21/hardware/safe" />
<meta property="og:site_name" content="m4rcix" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-03-17T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="A safe place" />
<script type="application/ld+json">
{"description":"Oh boy, I almost put hard earned cash in there","@type":"BlogPosting","headline":"A safe place","dateModified":"2021-03-17T00:00:00+00:00","datePublished":"2021-03-17T00:00:00+00:00","url":"https://m4rcix.github.io/SecChall21/hardware/safe","author":{"@type":"Person","name":"m4rcix"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://m4rcix.github.io/SecChall21/hardware/safe"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css">
  <link rel="icon" type="image/png" href="/assets/favicon.png" /><link type="application/atom+xml" rel="alternate" href="https://m4rcix.github.io/feed.xml" title="m4rcix" /></head>
<body><div class="site-header">
  <div class="wrapper">
    <a class="site-title" rel="author" href="/">m4rcix<b class="command_prompt"></b><b class="blinking_cursor">_</b></a>
    <span class="social_links">
        
        
        <a class="color-cyan-hover" href="https://twitter.com/MarcixWasTaken"><i class="fab fa-twitter-square"></i></a>
        
        
        
        <a class="color-purple-hover" href="https://www.twitch.tv/marcix"><i class="fab fa-twitch"></i></a>
        
        
        
        <a class="color-red-hover" href="https://www.youtube.com/channel/UChaUSPtWwNkUpzrjUW7H0PA"><i class="fab fa-youtube"></i></a>
        
        
        
        <a class="color-yellow-hover" href="https://github.com/m4rcix"><i class="fab fa-github-square"></i></a>
        
        
        
        <a class="color-blue-hover" href="https://www.linkedin.com/in/marton-bak-574a59201/"><i class="fab fa-linkedin"></i></a>
        
        
        
        <a class="color-green-hover" href="https://app.hackthebox.eu/profile/367067"><i class="fa fa-cube"></i></a>
        
        
        
        <a class="color-blue-hover" href="https://discord.com/invite/wGHG5Aj"><i class="fab fa-discord"></i></a>
        
        
    </span>
  </div>
</div>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        
<div class="post">
  <h1 class="post-title">A safe place</h1>
  
  <div class="post-tags">
      
  </div>
  
  <div class="post-date">Published on 17 Mar 2021</div>
  
  <noscript>
    <div class="post-description">Oh boy, I almost put hard earned cash in there</div>
  </noscript>
  <div id="animated-post-description" class="post-description" style="display: none;"></div>
  
  <h2 id="description">Description</h2>

<p>V8? What did they mean by leaving V8 behind on the ACME servers? Perhaps the war boys deleted the manual? They must have a copy of it! Wait a minute… I remember that Joe has a little home made safe in his room. Maybe its in there?</p>

<p>You examine the safe, and there is a display on the front, a dial and two buttons. It feels like that the whole thing is made out of scrap electronics. The dial rotates like a rotary encoder, and the thing beeps as you press the buttons. You managed to take the cover off the dial and the next button. Bingo! You can see the rotary encoder and the button’s connectors. You hook up your trusty logic analyzer, and wait for Joe to unlock it. After a few hours, you managed to log the signals while the safe has been opened, but it looks like the encoder is not the best quality.</p>

<p>Your task is to figure out the code and open the safe. The counter starts from 0. After you figure out the code, you can use the webpage to enter it on the safe, and receive the flag.</p>

<p><a href="https://a-safe-place.secchallenge.crysys.hu">https://a-safe-place.secchallenge.crysys.hu</a></p>

<p>The webpage shall be only used for code verification and flag retrieval. Please do not try to brute force the code via the webpage, you’ll not succeed.</p>

<ul>
  <li>Author: Csf3r3ncz1</li>
  <li>Difficulty: medium</li>
  <li>Attachment: <a href="/media/SecChall21/Hardware/Safe/safe_challenge.sal">safe_challenge.sal</a></li>
</ul>

<h2 id="solution">Solution</h2>

<ul>
  <li>Looking at other challenges already, I knew a program to open <code class="language-plaintext highlighter-rouge">.sal</code> files with, called <a href="https://discuss.saleae.com/">Salae Logic 2</a></li>
  <li>The challenge said something about <code class="language-plaintext highlighter-rouge">rotary encoder</code> so I googled and found <a href="https://en.wikipedia.org/wiki/Rotary_encoder">this</a></li>
</ul>

<p>I opened the given file with Salae Logic 2, and started looking at the signals. Some few key points from the linked wiki page, which helped me understand and solve the challenge easily.</p>

<ul>
  <li>If A is followed by B rotation is positive</li>
  <li>If B is followed by A rotation is negative</li>
</ul>

<p>I almost started coding when I realized two things:</p>
<ul>
  <li>The signals are noisy, which would make it problemmatic to detect by script</li>
  <li>There aren’t that many rotations that I cannot solve this by hand</li>
</ul>

<p>So I started working. When you launch the site, it starts from 0, so that’s where I started, counting the rotations tirelessly. After a bit, I had the combination at hand. (Which I won’t share, since it would be a freebie after that)</p>

<p>The acquired flag is:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd21{HIDDEN}
</code></pre></div></div>

<p><a href="/SecChall21">← Back to SecChallenge21</a></p>

</div>







  
  <h2>all tags</h2>
  <div class="tag-cloud"><a href="/tag/ctf/" class="set-1">CTF</a> <a href="/tag/crypto/" class="set-1">crypto</a> <a href="/tag/crysys/" class="set-1">crysys</a> <a href="/tag/dnspy/" class="set-1">dnSpy</a> <a href="/tag/hardware/" class="set-2">hardware</a> <a href="/tag/misc/" class="set-2">misc</a> <a href="/tag/pwn/" class="set-1">pwn</a> <a href="/tag/reverse/" class="set-1">reverse</a> <a href="/tag/secchallenge/" class="set-5">secchallenge</a> <a href="/tag/web/" class="set-2">web</a></div>
  




<script>
  let i = 0;
  const text = 'Oh boy, I almost put hard earned cash in there';
  const speed = parseInt('50');
  
  function typeWriter() {
    if (i < text.length) {
      document.getElementById('animated-post-description').innerHTML += text.charAt(i);
      i++;
      setTimeout(typeWriter, speed);
    }
  }

  document.getElementById('animated-post-description').style.display = 'initial';
  typeWriter();
</script>

      </div>
    </main><footer class="site-footer">
  <div class="wrapper">
    <div class="credits"><a href="https://github.com/bitbrain/jekyll-dash">dash</a> theme for Jekyll by <a href="https://github.com/bitbrain">bitbrain</a> made with <i class="fas fa-heart"></i><div class="toggleWrapper">
    <input type="checkbox" class="dn" id="theme-toggle" onclick="modeSwitcher()" checked />
    <label for="theme-toggle" class="toggle">
    <span class="toggle__handler">
      <span class="crater crater--1"></span>
      <span class="crater crater--2"></span>
      <span class="crater crater--3"></span>
    </span>
        <span class="star star--1"></span>
        <span class="star star--2"></span>
        <span class="star star--3"></span>
        <span class="star star--4"></span>
        <span class="star star--5"></span>
        <span class="star star--6"></span>
    </label>
</div>
<script type="text/javascript">
const theme = localStorage.getItem('theme');

if (theme === "light") {
    document.documentElement.setAttribute('data-theme', 'light');
} else {
    document.documentElement.setAttribute('data-theme', 'dark');
}
const userPrefers = getComputedStyle(document.documentElement).getPropertyValue('content');

function activateDarkTheme() {
    document.getElementById('theme-toggle').checked = true;
    document.documentElement.setAttribute('data-theme', 'dark');
    document.documentElement.classList.add('theme--dark');
    document.documentElement.classList.remove('theme--light');
	document.getElementById("theme-toggle").className = 'light';
	window.localStorage.setItem('theme', 'dark');
}

function activateLightTheme() {
    document.getElementById('theme-toggle').checked = false;
    document.documentElement.setAttribute('data-theme', 'light');
    document.documentElement.classList.add('theme--light');
    document.documentElement.classList.remove('theme--dark');
	document.getElementById("theme-toggle").className = 'dark';
	window.localStorage.setItem('theme', 'light');
}

if (theme === "dark") {
    activateDarkTheme();
} else if (theme === "light") {
    activateLightTheme();
} else if  (userPrefers === "light") {
    activateDarkTheme();
} else {
    activateDarkTheme();
}

function modeSwitcher() {
	let currentMode = document.documentElement.getAttribute('data-theme');
	if (currentMode === "dark") {
	    activateLightTheme();
	} else {
	    activateDarkTheme();
	}
}
</script></div>
  </div>
</footer>


<script>
      window.FontAwesomeConfig = {
        searchPseudoElements: true
      }
    </script>
  </body>

</html>
